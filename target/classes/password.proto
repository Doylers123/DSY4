syntax = 'proto3';

package ie.gmit.ds;

option java_package = "ie.gmit.ds";

option java_multiple_files = true;

import "google/protobuf/wrappers.proto";

service PasswordService
{
    rpc hash(HashInput) returns (HashOutput);
    rpc validate(ValidInput) returns (google.protobuf.BoolValue);

}

message HashInput
{
    int32 userId = 1;
    string password = 2;
}

message HashOutput
{
    int32 userId = 1;
    bytes hashedPassword = 2;
    bytes salt = 3;
}

message ValidInput
{
    string password = 1;
    bytes hashedPassword = 2;
    bytes salt = 3;
}
